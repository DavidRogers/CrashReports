@using CrashReports.Models
@model FullReportViewModel

@{
	ViewBag.Title = "Applications";
	TimeZoneInfo pstTimeZone = TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time");
	string groupName = "";
}

<div class="full-report-banner">
	@foreach (string app in Model.Applications)
	{
		@Html.ActionLink(app, "Application", new { appName = app})
	}
</div>

<h3>Latest Reports from the last 14 days</h3>
@foreach (ReportModel report in Model.Reports.OrderByDescending(x => x.ApplicationVersion).ThenByDescending(x => x.LastCrash))
{
		if (groupName != report.AppVersion)
		{
			groupName = report.AppVersion;
			<h4>@groupName</h4>
		}

		<div class="crash-report">
		<p><strong>@TimeZoneInfo.ConvertTimeFromUtc(report.LastCrash, pstTimeZone).ToString("g")</strong> @Html.ActionLink(report.Title, "Log", new { id = report.Id }) (@report.Occurences)</p>
	</div>
}
